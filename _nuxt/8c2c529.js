(window.webpackJsonp=window.webpackJsonp||[]).push([[15,7],{861:function(t,e,n){"use strict";n.r(e);n(81);var o=n(1),r=n(14);function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var l={mixins:[n(46).a],props:{discussion:{type:Object,default:null}},data:function(){return{copyDirectLinkSuccess:!1}},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(r.b)("github",{githubUser:"user"})),methods:{getDirectLink:function(){return"".concat(window.location.origin,"/#/d/")},copiedDirectLink:function(){var t=this;this.copyDirectLinkSuccess=!0,setTimeout((function(){t.copyDirectLinkSuccess=!1}),1e3)}}},d=n(11),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"embed border rounded-xl px-2 pb-3 mb-2",staticStyle:{"margin-top":"-56px","padding-top":"56px"}},[n("div",{staticClass:"d-flex justify-content-between align-items-center"},[n("a",{staticClass:"text-truncate text-dark",attrs:{href:t.discussion.url,target:"_blank"}},[n("b",[t._v(t._s(t.discussion.title))])]),t._v(" "),n("div",{directives:[{name:"clipboard",rawName:"v-clipboard",value:t.getDirectLink(t.discussion.title),expression:"getDirectLink(discussion.title)"},{name:"clipboard",rawName:"v-clipboard:success",value:t.copiedDirectLink,expression:"copiedDirectLink",arg:"success"},{name:"tooltip",rawName:"v-tooltip",value:{content:"Direct link",trigger:"hover"},expression:"{\n        content: 'Direct link',\n        trigger: 'hover',\n      }"}],staticClass:"btn btn-sm btn-light mr-1"},[n("transition",{attrs:{name:"fade",mode:"out-in"}},[t.copyDirectLinkSuccess?n("span",{staticClass:"text-muted"},[t._v("\n          copied\n          "),n("font-awesome-icon",{staticClass:"text-success",attrs:{icon:["fas","check"],"fixed-width":""}})],1):n("font-awesome-icon",{staticClass:"text-muted",attrs:{icon:["fas","share-alt"],"fixed-width":""}})],1)],1)]),t._v(" "),n("small",{staticClass:"text-muted mt-1 d-flex justify-content-between"},[t._v("\n    created\n    "+t._s(t._f("moment")(t.discussion.createdAt,"MMM Do YYYY"))+"\n  ")])])}),[],!1,null,null,null);e.default=component.exports},883:function(t,e,n){"use strict";n.r(e);n(105),n(21),n(64),n(218),n(81);var o=n(1),r=n(14);function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var l={mixins:[n(46).a],data:function(){return{success:!1,proposalDepartment:null,discussionUrl:"",discussion:null,startDate:null,endDate:null,quorum:null,loadingDiscussion:!1,loadDiscussionTimeout:null,waitingForTransaction:!1}},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(r.b)(["ownDepartments","selectedDepartment","account"])),watch:{discussionUrl:function(t){var e=this;clearTimeout(this.loadDiscussionTimeout),this.loadDiscussionTimeout=setTimeout((function(){var n=t.match(/^https:\/\/github\.com\/([\w-]+)\/([\w-]+)\/discussions\/(\d+)$/);if(n){var o=n[1],r=n[2],c=n[3];e.loadingDiscussion=!0,e.discussion=null,e.$github.getDiscussionByOwnerRepoNumber(o,r,Number(c)).then((function(t){e.discussion=t})).catch((function(){e.discussion=null})).finally((function(){return e.loadingDiscussion=!1}))}else e.discussion=null,e.loadingDiscussion=!1}),500)}},mounted:function(){this.proposalDepartment=this.selectedDepartment},methods:{createNewProposal:function(){var t=this,e=this.discussion.repository.id,n=this.discussion.id,o=new Date(this.startDate).getTime()/1e3,r=new Date(this.endDate).getTime()/1e3,c=100*Number(this.quorum);this.waitingForTransaction=!0,this.octobayGovernor.methods.createProposal(this.proposalDepartment.tokenAddress,e,n,o,r,c).send({from:this.account}).then((function(){t.success=!0,setTimeout((function(){t.$store.dispatch("updateDepartments").then((function(){t.discussionUrl="",t.discussion=null,t.startDate=null,t.endDate=null,t.quorum=null,t.waitingForTransaction=!1,setTimeout((function(){t.closeModal()}),1e3)}))}),3e3)}))}}},d=n(11),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card shadow-sm d-flex flex-column",on:{click:function(t){t.stopPropagation()}}},[t.success?n("div",{staticClass:"alert alert-success mb-0"},[n("font-awesome-icon",{attrs:{icon:["fas","check"]}}),t._v("\n    Proposal created successfully! :)\n  ")],1):n("div",[n("div",{staticClass:"card-body modal-body flex-fill"},[n("h5",{staticClass:"text-center text-muted-light py-3 px-4 m-0"},[t._v("New Proposal")]),t._v(" "),n("div",[n("b",[t._v("Link to Discussion on GitHub")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.discussionUrl,expression:"discussionUrl"}],staticClass:"form-control form-control-lg form-control-with-embed mb-2",attrs:{type:"text",placeholder:"https://github.com/..."},domProps:{value:t.discussionUrl},on:{input:function(e){e.target.composing||(t.discussionUrl=e.target.value)}}}),t._v(" "),t.discussion?n("DiscussionEmbed",{attrs:{discussion:t.discussion}}):t._e()],1),t._v(" "),n("div",[n("small",[t._v("Governance Department")]),t._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.proposalDepartment,expression:"proposalDepartment"}],staticClass:"custom-select rounded-xl",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.proposalDepartment=e.target.multiple?n:n[0]}}},[n("option",{domProps:{value:null}},[t._v("Select department")]),t._v(" "),t._l(t.ownDepartments,(function(e){return n("option",{key:e.address,domProps:{value:e}},[t._v("\n            "+t._s(e.name)+"\n          ")])}))],2)]),t._v(" "),t.proposalDepartment?n("div",[n("small",[t._v("Quorum")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.quorum,expression:"quorum"}],staticClass:"form-control",attrs:{type:"number",min:t.proposalDepartment.minQuorum/100,max:"100"},domProps:{value:t.quorum},on:{input:function(e){e.target.composing||(t.quorum=e.target.value)}}})]):t._e(),t._v(" "),t.proposalDepartment?n("div",{staticClass:"mt-2"},[n("div",{staticClass:"d-flex align-items-end"},[n("div",{staticClass:"mr-1"},[n("small",{staticClass:"d-flex"},[t._v("Start Date")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.startDate,expression:"startDate"}],staticClass:"form-control mb-2",attrs:{type:"date",placeholder:"Mar 29th 2021"},domProps:{value:t.startDate},on:{input:function(e){e.target.composing||(t.startDate=e.target.value)}}})]),t._v(" "),n("div",{staticClass:"ml-1"},[n("small",{staticClass:"d-flex"},[t._v("End Date")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.endDate,expression:"endDate"}],staticClass:"form-control mb-2",attrs:{type:"date",placeholder:"Apr 29th 2021"},domProps:{value:t.endDate},on:{input:function(e){e.target.composing||(t.endDate=e.target.value)}}})])])]):t._e()]),t._v(" "),n("div",{staticClass:"card-body pt-0"},[n("button",{staticClass:"btn btn-lg btn-primary w-100 shadow-sm",attrs:{disabled:t.waitingForTransaction||!t.proposalDepartment},on:{click:function(e){return t.createNewProposal()}}},[t.waitingForTransaction?n("font-awesome-icon",{attrs:{icon:["fas","circle-notch"],spin:""}}):t._e(),t._v("\n        Create Proposal\n      ")],1)])])])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{DiscussionEmbed:n(861).default})}}]);